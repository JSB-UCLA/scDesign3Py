<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>scDesign3Py.scDesign3.simu_new &mdash; scDesign3Py  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="scDesign3Py.scDesign3.scdesign3" href="scDesign3Py.scDesign3.scdesign3.html" />
    <link rel="prev" title="scDesign3Py.scDesign3.extract_para" href="scDesign3Py.scDesign3.extract_para.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            scDesign3Py
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.scDesign3.html">scDesign3Py.scDesign3</a></li>
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.scDesign3.__init__.html">scDesign3Py.scDesign3.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.scDesign3.construct_data.html">scDesign3Py.scDesign3.construct_data</a></li>
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.scDesign3.fit_marginal.html">scDesign3Py.scDesign3.fit_marginal</a></li>
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.scDesign3.fit_copula.html">scDesign3Py.scDesign3.fit_copula</a></li>
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.scDesign3.extract_para.html">scDesign3Py.scDesign3.extract_para</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">scDesign3Py.scDesign3.simu_new</a></li>
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.scDesign3.scdesign3.html">scDesign3Py.scDesign3.scdesign3</a></li>
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.scDesign3.set_r_random_seed.html">scDesign3Py.scDesign3.set_r_random_seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.get_bpparam.html">scDesign3Py.get_bpparam</a></li>
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.perform_lrt.html">scDesign3Py.perform_lrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="scDesign3Py.plot_reduceddim.html">scDesign3Py.plot_reduceddim</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info.html">About scDesign3Py</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/all_in_one.html">All in one simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/stepwise.html">Step by step simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/bpparam.html">Get BPPARAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/lrt.html">Perform likelihood ratio test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/plot.html">Plot results</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/model_para/index.html">Model parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/data_simu/index.html">Data simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/model_select/index.html">Model selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/model_alter/index.html">Model alteration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">scDesign3Py</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../API.html">API</a></li>
      <li class="breadcrumb-item active">scDesign3Py.scDesign3.simu_new</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/DILIU899/scDesign3Py/blob/main/docs/source/set_up/_autosummary/scDesign3Py.scDesign3.simu_new.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="scdesign3py-scdesign3-simu-new">
<h1>scDesign3Py.scDesign3.simu_new<a class="headerlink" href="#scdesign3py-scdesign3-simu-new" title="Link to this heading"></a></h1>
<dl class="py method">
<dt class="sig sig-object py" id="scDesign3Py.scDesign3.simu_new">
<span class="sig-prename descclassname"><span class="pre">scDesign3.</span></span><span class="sig-name descname"><span class="pre">simu_new</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mean_mat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sigma_mat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'zero_mat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copula_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">rpy2.robjects.vectors.ListVector</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">rpy2.rlike.container.OrdDict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'dat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_covariate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.DataFrame</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'newCovariate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family_use</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'binomial'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'poisson'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'nb'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'zip'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'zinb'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'gaussian'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">important_feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'all'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'auto'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">rpy2.robjects.BoolVector</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fastmvn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonnegative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonzerovar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_gene</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'mcmapply'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bpmapply'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'pbmcmapply'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">rpy2.robjects.methods.RS4</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_py</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">rpy2.robjects.vectors.FloatMatrix</span></span></span><a class="reference internal" href="../../_modules/scDesign3Py/_core.html#scDesign3.simu_new"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scDesign3Py.scDesign3.simu_new" title="Link to this definition"></a></dt>
<dd><p>Simulate new data</p>
<p>Generate new simulated data based on fitted marginal and copula models.</p>
<section id="details">
<h2>Details:<a class="headerlink" href="#details" title="Link to this heading"></a></h2>
<p>The function takes the new covariate (if use) from &#64;construct_data, parameter matricies from &#64;extract_para and multivariate Unifs from &#64;fit_copula.</p>
</section>
<section id="arguments">
<h2>Arguments:<a class="headerlink" href="#arguments" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>mean_mat: <cite>numpy.ndarray</cite> or <cite>pandas.DataFrame</cite> (default: ‘mean_mat’)</dt><dd><p>A matrix of the mean parameter. Default is ‘mean_mat’, use the &#64;model_paras, mean_mat output.</p>
</dd>
<dt>sigma_mat: <cite>numpy.ndarray</cite> or <cite>pandas.DataFrame</cite> (default: ‘sigma_mat’)</dt><dd><p>A matrix of the sigma parameter. Default is ‘sigma_mat’, use the &#64;model_paras, sigma_mat output.</p>
</dd>
<dt>zero_mat: <cite>numpy.ndarray</cite> or <cite>pandas.DataFrame</cite> (default: ‘zero_mat’)</dt><dd><p>A matrix of the zero-inflation parameter. Default is ‘zero_mat’, use the &#64;model_paras, zero_mat output.</p>
</dd>
<dt>quantile_mat: <cite>numpy.ndarray</cite> or <cite>pandas.DataFrame</cite> (default: None)</dt><dd><p>A matrix of the multivariate quantile. Default is None, if parameter &#64;copula_dict is provided.</p>
</dd>
<dt>copula_dict: <cite>rpy2.robject.vectors.ListVector</cite> or <cite>rpy2.rlike.container.OrdDict</cite> or <cite>dict</cite> (default: ‘default’)</dt><dd><p>Copulas for generating the multivariate quantile matrix. Default is ‘default’, use the &#64;fit_copula_res, copula_list output.</p>
</dd>
<dt>data: <cite>str</cite> or <cite>pandas.DataFrame</cite> (default: ‘dat’)</dt><dd><p>An input count matrix. Default is ‘dat’, use the &#64;construct_data_res, ‘dat’ output.</p>
</dd>
<dt>new_covariate: <cite>str</cite> or <cite>pandas.DataFrame</cite> (default: ‘newCovariate’)</dt><dd><p>A dataframe which contains covariates of targeted simulated data from &#64;construct_data. Default is ‘newCovariate’, use the &#64;construct_data_res, ‘newCovariate’ output.</p>
</dd>
<dt>family_use: <cite>str</cite> or <cite>list[str]</cite> (default: ‘default’)</dt><dd><p>A string or a list of strings of the marginal distribution. Must be one of ‘binomial’, ‘poisson’, ‘nb’, ‘zip’, ‘zinb’ or ‘gaussian’. Default is ‘default’, use the class property &#64;family_use.</p>
</dd>
<dt>important_feature: <cite>str</cite> or <cite>list[bool]</cite> or <cite>rpy2.robject.vectors.BoolVector</cite> (default: ‘all’)</dt><dd><p>A string or list which indicates whether a gene will be used in correlation estimation or not. If this is a string, then this string must be either “all” (using all genes) or “auto”, which indicates that the genes will be automatically selected based on the proportion of zero expression across cells for each gene. Gene with zero proportion greater than 0.8 will be excluded form gene-gene correlation estimation. If this is a list, then this should be a logical vector with length equal to the number of genes in &#64;sce. True in the logical vector means the corresponding gene will be included in gene-gene correlation estimation and False in the logical vector means the corresponding gene will be excluded from the gene-gene correlation estimation.</p>
</dd>
<dt>fastmvn: <cite>bool</cite> (default: False)</dt><dd><p>If True, the sampling of multivariate Gaussian is done by R function mvnfast, otherwise by R function mvtnorm.</p>
</dd>
<dt>nonnegative: <cite>bool</cite> (default: True)</dt><dd><p>If True, values &lt; 0 in the synthetic data will be converted to 0. Default is True, since the expression matrix is nonnegative.</p>
</dd>
<dt>nonzerovar: <cite>bool</cite> (default: False)</dt><dd><p>If True, for any gene with zero variance, a cell will be replaced with 1. This is designed for avoiding potential errors, for example, PCA.</p>
</dd>
<dt>filtered_gene: <cite>None</cite> or <cite>list[str]</cite> (default: ‘default’)</dt><dd><p>None or a list which contains genes that are excluded in the marginal and copula fitting steps because these genes only express in less than two cells. Default is ‘default’, use the &#64;construct_data_res, ‘filtered_gene’ output.</p>
</dd>
<dt>n_cores: <cite>int</cite> (default: ‘default’)</dt><dd><p>The number of cores to use. Default is ‘default’, use the setting when initializing.</p>
</dd>
<dt>parallelization: <cite>str</cite> (default: ‘default’)</dt><dd><p>The specific parallelization function to use. If ‘bpmapply’, first call method &#64;get_bpparam. Default is ‘default’, use the setting when initializing.</p>
</dd>
<dt>bpparam: <cite>rpy2.robject.methods.RS4</cite> (default: ‘default’)</dt><dd><p>If &#64;parallelization is ‘bpmapply’, first call function &#64;get_bpparam to get the robject. If &#64;parallelization is ‘mcmapply’ or ‘pbmcmapply’, it should be None. Default is ‘default’, use the setting when initializing.</p>
</dd>
<dt>return_py: <cite>bool</cite> (default: ‘default’)</dt><dd><p>If True, functions will return a result easy for manipulation in python. Default is ‘default’, use the setting when initializing.</p>
</dd>
</dl>
</section>
<section id="output">
<h2>Output:<a class="headerlink" href="#output" title="Link to this heading"></a></h2>
<dl>
<dt><cite>pandas.DataFrame</cite></dt><dd><p>The new simulated count (expression) matrix.</p>
<p>The row corresponds to the observations and the column corresponds to the genes.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="scDesign3Py.scDesign3.extract_para.html" class="btn btn-neutral float-left" title="scDesign3Py.scDesign3.extract_para" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="scDesign3Py.scDesign3.scdesign3.html" class="btn btn-neutral float-right" title="scDesign3Py.scDesign3.scdesign3" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Di Liu.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>