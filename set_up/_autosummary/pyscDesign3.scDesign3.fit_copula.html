<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyscDesign3.scDesign3.fit_copula &mdash; pyscDesign3  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pyscDesign3.scDesign3.extract_para" href="pyscDesign3.scDesign3.extract_para.html" />
    <link rel="prev" title="pyscDesign3.scDesign3.fit_marginal" href="pyscDesign3.scDesign3.fit_marginal.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            pyscDesign3
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pyscDesign3.scDesign3.html">pyscDesign3.scDesign3</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscDesign3.scDesign3.__init__.html">pyscDesign3.scDesign3.__init__</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscDesign3.scDesign3.construct_data.html">pyscDesign3.scDesign3.construct_data</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscDesign3.scDesign3.fit_marginal.html">pyscDesign3.scDesign3.fit_marginal</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">pyscDesign3.scDesign3.fit_copula</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscDesign3.scDesign3.extract_para.html">pyscDesign3.scDesign3.extract_para</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscDesign3.scDesign3.simu_new.html">pyscDesign3.scDesign3.simu_new</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscDesign3.scDesign3.scdesign3.html">pyscDesign3.scDesign3.scdesign3</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscDesign3.get_bpparam.html">pyscDesign3.get_bpparam</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscDesign3.perform_lrt.html">pyscDesign3.perform_lrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyscDesign3.plot_reduceddim.html">pyscDesign3.plot_reduceddim</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info.html">About pyscDesign3</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/all_in_one.html">All in one simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/stepwise.html">Step by step simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/bpparam.html">Get BPPARAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/lrt.html">Perform likelihood ratio test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/plot.html">Plot results</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/data_simu/index.html">Data simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/model_para/index.html">Model parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/model_select/index.html">Model selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/model_alter/index.html">Model alteration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyscDesign3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../API.html">API</a></li>
      <li class="breadcrumb-item active">pyscDesign3.scDesign3.fit_copula</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/DILIU899/pyscDesign3/blob/develop/docs/source/set_up/_autosummary/pyscDesign3.scDesign3.fit_copula.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pyscdesign3-scdesign3-fit-copula">
<h1>pyscDesign3.scDesign3.fit_copula<a class="headerlink" href="#pyscdesign3-scdesign3-fit-copula" title="Permalink to this heading"></a></h1>
<dl class="py method">
<dt class="sig sig-object py" id="pyscDesign3.scDesign3.fit_copula">
<span class="sig-prename descclassname"><span class="pre">scDesign3.</span></span><span class="sig-name descname"><span class="pre">fit_copula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'count_mat'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'dat'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'newCovariate'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'dat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copula</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'gaussian'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'vine'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empirical_quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginal_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">rpy2.robjects.vectors.ListVector</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">rpy2.rlike.container.OrdDict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family_use</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'binomial'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'poisson'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'nb'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'zip'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'zinb'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'gaussian'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family_set</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['gaussian',</span> <span class="pre">'indep']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">important_feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'all'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'auto'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'mcmapply'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bpmapply'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'pbmcmapply'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">rpy2.robjects.methods.RS4</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_py</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">rpy2.robjects.vectors.ListVector</span></span></span><a class="reference internal" href="../../_modules/pyscDesign3/_core.html#scDesign3.fit_copula"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyscDesign3.scDesign3.fit_copula" title="Permalink to this definition"></a></dt>
<dd><p>Fit the copula model</p>
<p>&#64;fit_copula fits the copula model.</p>
<section id="details">
<h2>Details:<a class="headerlink" href="#details" title="Permalink to this heading"></a></h2>
<p>This function takes the result from &#64;fit_marginal as the input and fit the copula model on the residuals.</p>
</section>
<section id="arguments">
<h2>Arguments:<a class="headerlink" href="#arguments" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>input_data: <cite>str</cite> or <cite>pandas.DataFrame</cite> (default: ‘dat’)</dt><dd><p>One of the output of &#64;construct_data, only need to specify the name if directly use the &#64;construct_data_res. An alternative is to directly provided the corresponding DataFrame.</p>
</dd>
<dt>copula: <cite>str</cite> (default: ‘gaussian’)</dt><dd><p>A string of the copula choice. Must be one of ‘gaussian’ or ‘vine’. Note that vine copula may have better modeling of high-dimensions, but can be very slow when features are &gt;1000.</p>
</dd>
<dt>empirical_quantile: <cite>bool</cite> (default: False)</dt><dd><p>Please only use it if you clearly know what will happen! If True, DO NOT fit the copula and use the EMPIRICAL CDF values of the original data; it will make the simulated data fixed (no randomness). Only works if ncell is the same as your original data.</p>
</dd>
<dt>marginal_dict: <cite>rpy2.robject.vectors.ListVector</cite> or <cite>rpy2.rlike.container.OrdDict</cite> or <cite>dict</cite> (default: ‘default’)</dt><dd><p>The result of &#64;fit_marginal. Default is ‘default’, using the class property &#64;fit_marginal_res.</p>
</dd>
<dt>family_use: <cite>str</cite> or <cite>list[str]</cite> (default: ‘default’)</dt><dd><p>A string or a list of strings of the marginal distribution. Must be one of ‘binomial’, ‘poisson’, ‘nb’, ‘zip’, ‘zinb’ or ‘gaussian’. Default is ‘default’, use the class property &#64;family_use.</p>
</dd>
<dt>dt: <cite>bool</cite> (default: True)</dt><dd><p>If True, perform the distributional transformation to make the discrete data continuous. This is useful for discrete distributions (e.g., Poisson, NB). Note that for continuous data (e.g., Gaussian), DT does not make sense and should be set as False.</p>
</dd>
<dt>pseudo_obs: <cite>bool</cite> (default: False)</dt><dd><p>If True, use the empirical quantiles instead of theoretical quantiles for fitting copula.</p>
</dd>
<dt>epsilon: <cite>float</cite> (default: 1e-6)</dt><dd><p>A numeric variable for preventing the transformed quantiles to collapse to 0 or 1.</p>
</dd>
<dt>family_set: <cite>str</cite> or <cite>list[str]</cite> (default: [‘gaussian’, ‘indep’])</dt><dd><p>A string or a string list of the bivariate copula families.</p>
</dd>
<dt>important_feature: <cite>str</cite> or <cite>list[bool]</cite> (default: ‘all’)</dt><dd><p>A string or list which indicates whether a gene will be used in correlation estimation or not. If this is a string, then this string must be either “all” (using all genes) or “auto”, which indicates that the genes will be automatically selected based on the proportion of zero expression across cells for each gene. Gene with zero proportion greater than 0.8 will be excluded form gene-gene correlation estimation. If this is a list, then this should be a logical vector with length equal to the number of genes in &#64;sce. True in the logical vector means the corresponding gene will be included in gene-gene correlation estimation and False in the logical vector means the corresponding gene will be excluded from the gene-gene correlation estimation.</p>
</dd>
<dt>n_cores: <cite>int</cite> (default: ‘default’)</dt><dd><p>The number of cores to use. Default is ‘default’, use the setting when initializing.</p>
</dd>
<dt>parallelization: <cite>str</cite> (default: ‘default’)</dt><dd><p>The specific parallelization function to use. If ‘bpmapply’, first call method &#64;get_bpparam. Default is ‘default’, use the setting when initializing.</p>
</dd>
<dt>bpparam: <cite>rpy2.robject.methods.RS4</cite> (default: ‘default’)</dt><dd><p>If &#64;parallelization is ‘bpmapply’, first call function &#64;get_bpparam to get the robject. If &#64;parallelization is ‘mcmapply’ or ‘pbmcmapply’, it should be None. Default is ‘default’, use the setting when initializing.</p>
</dd>
<dt>return_py: <cite>bool</cite> (default: ‘default’)</dt><dd><p>If True, functions will return a result easy for manipulation in python. Default is ‘default’, use the setting when initializing.</p>
</dd>
</dl>
</section>
<section id="output">
<h2>Output:<a class="headerlink" href="#output" title="Permalink to this heading"></a></h2>
<p>A <cite>dict</cite> like object.</p>
<dl>
<dt>model_aic: <cite>pandas.Series</cite></dt><dd><p>An array with three values. In order, they are the marginal AIC, the copula AIC, the total AIC.</p>
</dd>
<dt>model_bic: <cite>pandas.Series</cite></dt><dd><p>An array with three values. In order, they are the marginal BIC, the copula BIC, the total BIC.</p>
</dd>
<dt>important_feature: <cite>list[bool]</cite></dt><dd><p>A vector showing the genes regarded as the inportant genes.</p>
</dd>
<dt>copula_list: <cite>rpy2.rlike.container.OrdDict</cite></dt><dd><p>A dict of the fitted copula model. If using Gaussian copula, a dict of correlation matrices; if vine, a dict of vine objects.</p>
<p>Caution that though it’s name is <cite>list</cite>, it is actually a <cite>dict</cite> like object.</p>
</dd>
</dl>
</section>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The return value is a <cite>rpy2.rlike.container.OrdDict</cite> . Not all elements in this <cite>dict</cite> like object have to be named but they have a given order. <strong>None</strong> as a key value means an absence of name for the element. For the values without a named key, you can call <cite>byindex</cite> method to get them by index (rank).</p>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pyscDesign3.scDesign3.fit_marginal.html" class="btn btn-neutral float-left" title="pyscDesign3.scDesign3.fit_marginal" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pyscDesign3.scDesign3.extract_para.html" class="btn btn-neutral float-right" title="pyscDesign3.scDesign3.extract_para" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Di Liu.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>